<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Job Satisfaction Portal</title>  
  <link rel="stylesheet" href="./style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- Navbar -->
<nav class="navbar">
  <div class="logo">JobSatisfy</div>
  <ul class="nav-links">
    <li><a href="#home">Home</a></li>
    <li><a href="#survey">Survey</a></li>
    <li><a href="#admin">Results</a></li>
    <li><a href="#footer">Contact</a></li>
  </ul>
</nav>

<!-- Home Section -->
<section id="home" class="home">
  <h1>Welcome to the Job Satisfaction Portal</h1>
  <p>Your voice matters! Please take a few moments to complete the survey and help improve your workplace.</p>
</section>

<!-- Survey Form Section -->
<section id="survey" class="survey">
  <form id="surveyForm">
    <h2>Employee Survey</h2>

    <!-- Name + Email -->
    <label for="name">Full Name</label>
    <input type="text" name="name" id="name" placeholder="Your Name" required />

    <label for="email">Email</label>
    <input type="email" name="email" id="email" placeholder="Your Email" required />

    <!-- Questions -->
    <label for="q1">1. How satisfied are you with your current role and responsibilities?</label>
    <select name="q1" id="q1" required>
      <option value="">Select</option>
      <option>Very Satisfied</option>
      <option>Satisfied</option>
      <option>Neutral</option>
      <option>Dissatisfied</option>
      <option>Very Dissatisfied</option>
    </select>

    <label for="q2">2. Do you feel recognized and appreciated for the work you do?</label>
    <select name="q2" id="q2" required>
      <option value="">Select</option>
      <option>Always</option>
      <option>Often</option>
      <option>Sometimes</option>
      <option>Rarely</option>
      <option>Never</option>
    </select>

    <label for="q3">3. How would you describe your overall work-life balance?</label>
    <select name="q3" id="q3" required>
      <option value="">Select</option>
      <option>Excellent</option>
      <option>Good</option>
      <option>Average</option>
      <option>Poor</option>
    </select>

    <label for="q4">4. How clear are your job expectations and performance goals?</label>
    <select name="q4" id="q4" required>
      <option value="">Select</option>
      <option>Very Clear</option>
      <option>Somewhat Clear</option>
      <option>Unclear</option>
    </select>

    <label for="q5">5. How satisfied are you with the support and guidance from your manager?</label>
    <select name="q5" id="q5" required>
      <option value="">Select</option>
      <option>Very Satisfied</option>
      <option>Satisfied</option>
      <option>Neutral</option>
      <option>Dissatisfied</option>
      <option>Very Dissatisfied</option>
    </select>

    <label for="q6">6. Do you believe there are fair opportunities for career growth in this organization?</label>
    <select name="q6" id="q6" required>
      <option value="">Select</option>
      <option>Strongly Agree</option>
      <option>Agree</option>
      <option>Neutral</option>
      <option>Disagree</option>
      <option>Strongly Disagree</option>
    </select>

    <label for="q7">7. How satisfied are you with the compensation and benefits provided?</label>
    <select name="q7" id="q7" required>
      <option value="">Select</option>
      <option>Very Satisfied</option>
      <option>Satisfied</option>
      <option>Neutral</option>
      <option>Dissatisfied</option>
      <option>Very Dissatisfied</option>
    </select>

    <label for="q8">8. How effective do you find communication within your team and organization?</label>
    <select name="q8" id="q8" required>
      <option value="">Select</option>
      <option>Very Effective</option>
      <option>Effective</option>
      <option>Neutral</option>
      <option>Ineffective</option>
      <option>Very Ineffective</option>
    </select>

    <label for="q9">9. How motivated do you feel to perform your best at work?</label>
    <select name="q9" id="q9" required>
      <option value="">Select</option>
      <option>Highly Motivated</option>
      <option>Motivated</option>
      <option>Neutral</option>
      <option>Unmotivated</option>
      <option>Very Unmotivated</option>
    </select>

    <label for="q10">10. Would you recommend this organization as a great place to work?</label>
    <select name="q10" id="q10" required>
      <option value="">Select</option>
      <option>Yes, definitely</option>
      <option>Maybe</option>
      <option>Not Sure</option>
      <option>Probably Not</option>
      <option>No</option>
    </select>

    <!-- Submit -->
    <button type="submit">Submit Survey</button>
    <p id="responseMsg"></p>
  </form>
</section>

<!-- Admin Results Section -->
<section id="admin" class="admin">
  <h2>ðŸ“Š Survey Results</h2>

  <button onclick="downloadExcel()" class="download-btn">
    ðŸ“¥ Download Excel
  </button>

  <div id="chart-grid" class="chart-grid">
    <canvas id="q1Chart"></canvas>
    <canvas id="q2Chart"></canvas>
    <canvas id="q3Chart"></canvas>
    <canvas id="q4Chart"></canvas>
    <canvas id="q5Chart"></canvas>
    <canvas id="q6Chart"></canvas>
    <canvas id="q7Chart"></canvas>
    <canvas id="q8Chart"></canvas>
    <canvas id="q9Chart"></canvas>
    <canvas id="q10Chart"></canvas>
  </div>
</section>

<!-- Footer -->
<footer id="footer" class="footer">
  <p>&copy; 2025 JobSatisfy | Built for Employee Wellness</p>
</footer>

<!-- Chart Script -->
<script>
  async function loadAllCharts() {
    try {
      const res = await fetch("http://localhost:3000/all-chart-data");
      const data = await res.json();

      Object.keys(data).forEach((question) => {
        const labels = data[question].map(item => item.answer);
        const counts = data[question].map(item => item.count);
        const ctx = document.getElementById(`${question}Chart`).getContext("2d");

        new Chart(ctx, {
          type: "pie",
          data: {
            labels,
            datasets: [{
              label: question.toUpperCase(),
              data: counts,
              backgroundColor: [
                "#3b82f6", "#10b981", "#facc15", "#f97316", "#ef4444", "#8b5cf6", "#06b6d4"
              ],
            }],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: `${question.toUpperCase()} Responses`,
                font: { size: 14, weight: 'bold' }
              },
              legend: {
                position: 'bottom',
                labels: { boxWidth: 12, font: { size: 10 } }
              }
            }
          }
        });
      });
    } catch (error) {
      console.error("Error loading chart data:", error);
    }
  }

  function downloadExcel() {
    window.location.href = "http://localhost:3000/download-excel";
  }

  window.onload = loadAllCharts;
</script>

<script src="../Javascript/script.js"></script>
</body>
</html>
